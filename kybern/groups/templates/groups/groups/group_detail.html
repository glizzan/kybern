{% extends 'accounts/base.html' %}

{% block content %}

    {% include 'groups/groups/html_templates_to_include.html' %}
    
    <div id="kybernApp">

        <div class="row">

            <div class="col-3">
                <router-view name="sidebar"></router-view>
            </div>
            
            <div class="col-9">
                <router-view name="main"></router-view>
            </div>

            <router-view name="modal"></router-view>

        </div>

    </div>

    <script type="application/javascript">

        const router = new VueRouter({
        routes: [
            {
                name: 'home',
                path: '/',
                components: {
                    sidebar: groupConfigComponent,
                    main: resourcesComponent
                }
            },
            {
                name: 'item-permissions',
                path: '/permissions/:item_id/:item_model/:item_name',
                props: { sidebar: false, main: true },
                components: {
                    sidebar: groupConfigComponent,
                    main: permissionedItemComponent
                }
            },
            {
                name: 'edit-group',
                path: '/edit group',
                components: {
                    sidebar: groupConfigComponent,
                    main: resourcesComponent,
                    modal: editGroupComponent
                },
            },
            {
                name: 'governance',
                path: '/governance',
                components: {
                    sidebar: groupConfigComponent,
                    main: governanceComponent
                }
            },
            {
                name: 'group-action-history',
                path: '/history',
                components: {
                    sidebar: groupConfigComponent,
                    main: governanceComponent,
                    modal: actionHistoryComponent
                }
            },
            {
                name: 'forum-detail',
                path: '/forums/:forum_id',
                props: { sidebar: false, main: true },
                components: {
                    sidebar: groupConfigComponent,
                    main: forumComponent
                }
            },
            {
                name: 'governance-forum-detail',
                path: '/forums/governance/:forum_id',
                props: { sidebar: false, main: true },
                components: {
                    sidebar: groupConfigComponent,
                    main: governanceForumComponent
                }
            },
            {
                name: 'add-new-forum',
                path: '/forums/new',
                components: {
                    sidebar: groupConfigComponent,
                    main: forumsListComponent,
                    modal: forumFormComponent
                }
            },
            {
                name: 'edit-forum',
                path: '/forums/:forum_id/edit',
                props: { sidebar: false, main: true, modal: true },
                components: {
                    sidebar: groupConfigComponent,
                    main: forumComponent,
                    modal: forumFormComponent
                }
            },
            {
                name: 'forum-action-history',
                path: '/forums/:forum_id/history/:item_id/:item_model/:item_name',
                props: { sidebar: false, main: true, modal: true },
                components: {
                    sidebar: groupConfigComponent,
                    main: forumComponent,
                    modal: actionHistoryComponent
                }
            },
            {
                name: 'add-new-post',
                path: '/forums/:forum_id/new_post',
                props: { sidebar: false, main: true, modal: true },
                components: {
                    sidebar: groupConfigComponent,
                    main: forumComponent,
                    modal: postFormComponent
                }
            },
            {
                name: 'edit-post',
                path: '/forums/:forum_id/posts/:post_id/edit',
                props: { sidebar: false, main: true, modal: true },
                components: {
                    sidebar: groupConfigComponent,
                    main: forumComponent,  // switch to postComponent once made
                    modal: postFormComponent
                }
            },
            {
                name: 'post-detail',
                path: '/forums/:forum_id/posts/:post_id',
                props: { sidebar: false, main: true },
                components: {
                    sidebar: groupConfigComponent,
                    main: postComponent
                }
            },
            {
                name: 'post-action-history',
                path: '/forums/:forum_id/posts/:post_id/history/:item_id/:item_model/:item_name',
                props: { sidebar: false, main: true, modal: true },
                components: {
                    sidebar: groupConfigComponent,
                    main: postComponent,
                    modal: actionHistoryComponent
                }
            },
            {
                name: 'comment-action-history',
                path: '/comments/:comment_id/history/:item_id/:item_model/:item_name',
                props: { sidebar: false, main: true, modal: true },
                components: {
                    sidebar: groupConfigComponent,
                    main: resourcesComponent,
                    modal: actionHistoryComponent
                }
            },
            {
                // we're also going to have to nest action detail on everything that could want it
                // too aren't we
                name: 'action-detail',
                path: '/actions/detail/:action_id',
                props: { sidebar: false, main: false, modal: true },
                components: {
                    sidebar: groupConfigComponent,
                    main: resourcesComponent,
                    modal: actionDetailComponent
                }
            },
            {
                name: 'add-new-list',
                path: '/lists/new',
                components: {
                    sidebar: groupConfigComponent,
                    main: resourcesComponent,
                    modal: listFormComponent
                }
            },
            {
                name: 'edit-list-info',
                path: '/lists/edit/:list_id',
                props: { sidebar: false, main: false, modal: true },
                components: {
                    sidebar: groupConfigComponent,
                    main: resourcesComponent,
                    modal: listFormComponent
                }
            },
            {
                name: 'list-detail',
                path: '/lists/detail/:list_id',
                props: { sidebar: false, main: true},
                components: {
                    sidebar: groupConfigComponent,
                    main: listComponent
                }
            },
            {
                name: 'edit-list-row',
                path: '/lists/detail/:list_id/rows/:mode/:row_index',
                props: { sidebar: false, main: true, modal: true},
                components: {
                    sidebar: groupConfigComponent,
                    main: listComponent,
                    modal: listRowFormComponent
                }
            },
            {
                name: 'add-list-row',
                path: '/lists/detail/:list_id/rows/:mode',
                props: { sidebar: false, main: true, modal: true},
                components: {
                    sidebar: groupConfigComponent,
                    main: listComponent,
                    modal: listRowFormComponent
                }
            },
            {
                name: 'list-action-history',
                path: '/lists/detail/:list_id/history/:item_id/:item_model/:item_name',
                props: { sidebar: false, main: true, modal: true},
                components: {
                    sidebar: groupConfigComponent,
                    main: listComponent,
                    modal: actionHistoryComponent
                }
            },
            {
                name: 'templates',
                path: '/templates/:scope/',
                props: { sidebar: false, main: true },
                components: {
                    sidebar: groupConfigComponent,
                    main: templateComponent
                }
            },
            {
                name: 'item-templates',
                path: '/templates/:scope/:target_id/:target_model',
                props: { sidebar: false, main: true },
                components: {
                    sidebar: groupConfigComponent,
                    main: templateComponent
                }
            },
            {
                name: 'advanced-permissions',
                path: '/advanced-permissions/:item_id/:item_model',
                props: { sidebar: false, main: true },
                components: {
                    sidebar: groupConfigComponent,
                    main: advancedPermissionsComponent
                }
            }

        ]
        })

        var kybernApp = new Vue({
            delimiters: ['[[', ']]'],
            el: '#kybernApp',
            store,
            router
        })

    </script>

{% endblock %}