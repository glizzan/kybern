<script type="text/x-template" id="edit_group_component_template">

    <b-modal id="edit_group_modal" size="md" :visible=true @hide="$router.go(-1)">

        <template v-slot:modal-header><h5>Edit Your Group</h5></template>

        <b-form-group id="name" label="Group name:" label-for="group_name">
            <b-form-input id="group_name" v-model="edited_group_name" required>
            </b-form-input>
        </b-form-group>

        <b-form-group id="description" label="Group description:" label-for="group_description">
            <b-form-textarea id="group_description" v-model="edited_group_description" required
                placeholder="Add a group description">
            </b-form-textarea>
        </b-form-group>

        <error-component :message=error_message></error-component>

        <template v-slot:modal-footer>
            <b-button variant="outline-secondary" class="btn-sm"  @click="save_edited_group">
                save</b-button>
            <router-link class="button" :to="{ name: 'home'}">
                <b-button variant="outline-secondary" class="btn-sm">close</b-button>
            </router-link>
        </template>

    </b-modal>

</script>

<script type="application/javascript">

    var editGroupComponent = Vue.component('edit-group-component', {
        delimiters: ['[[', ']]'],
        template: '#edit_group_component_template',
        store,
        data: function() {
            return {
                item_model: 'group',
                edited_group_name: '',
                edited_group_description: '',
                error_message: ''
            }
        },
        created () {
            this.edited_group_name = this.group_name
            this.edited_group_description = this.group_description
        },
        computed: {
            ...Vuex.mapState({ group_name: state => state.group_name,
                               group_description: state => state.group_description,
                               item_id: state => state.group_pk })
        },
        methods: {
            ...Vuex.mapActions(['changeGroupName', 'changeGroupDescription']),
            save_edited_group() {

                if (this.group_name != this.edited_group_name ) {
                    this.changeGroupName({ group_pk: this.item_id, new_name: this.edited_group_name })
                    .catch(error => { this.error_message = error })
                }

                if (this.group_description != this.edited_group_description) {
                    this.changeGroupDescription({ group_pk: this.item_id,
                        group_description: this.edited_group_description })
                    .catch(error => { this.error_message = error })
                }
            }
        }
    });


</script>